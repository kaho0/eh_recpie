{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kahon/Downloads/recipe-website-with-api/lib/wikimedia.ts"],"sourcesContent":["import type { Recipe } from \"@/lib/csv-parser\";\r\n\r\nconst API_ENDPOINT =\r\n  \"https://api.wikimedia.org/core/v1/wikipedia/en/search/page\";\r\nconst DEFAULT_PLACEHOLDER =\r\n  \"https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg\";\r\nconst USER_AGENT = \"recipe-website-demo/1.0 (contact@recipe-app.local)\";\r\nconst MIN_IMAGE_WIDTH = 400;\r\n\r\ntype WikimediaThumbnail = {\r\n  url: string;\r\n  width?: number;\r\n  height?: number;\r\n};\r\n\r\ntype WikimediaPage = {\r\n  title: string;\r\n  thumbnail?: WikimediaThumbnail;\r\n  originalimage?: { source: string; width?: number; height?: number };\r\n  content_urls?: {\r\n    desktop?: { page?: string };\r\n  };\r\n};\r\n\r\ntype WikimediaResponse = {\r\n  pages?: WikimediaPage[];\r\n};\r\n\r\nexport type WikimediaImageInfo = {\r\n  url: string;\r\n  width?: number;\r\n  height?: number;\r\n};\r\n\r\nconst CATEGORY_IMAGE_FALLBACKS: Record<string, string> = {\r\n  Desserts:\r\n    \"https://images.unsplash.com/photo-1499636136210-6f4ee915583e?auto=format&fit=crop&w=1200&q=60\",\r\n  \"Drinks Recipes\":\r\n    \"https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=1200&q=60\",\r\n  Dinner:\r\n    \"https://images.unsplash.com/photo-1555992336-cbfdbc9c7b11?auto=format&fit=crop&w=1200&q=60\",\r\n  Lunch:\r\n    \"https://images.unsplash.com/photo-1528712306091-ed0763094c98?auto=format&fit=crop&w=1200&q=60\",\r\n  Breakfast:\r\n    \"https://images.unsplash.com/photo-1496417263034-38ec4f0b665a?auto=format&fit=crop&w=1200&q=60\",\r\n  \"Side Dish\":\r\n    \"https://images.unsplash.com/photo-1505253668822-42074d58a7fa?auto=format&fit=crop&w=1200&q=60\",\r\n  \"Salad Recipes\":\r\n    \"https://images.unsplash.com/photo-1466978913421-dad2ebd01d17?auto=format&fit=crop&w=1200&q=60\",\r\n  Seafood:\r\n    \"https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=1200&q=60\",\r\n};\r\n\r\nconst imageCache = new Map<string, WikimediaImageInfo | null>();\r\n\r\nexport async function getWikimediaImage(\r\n  query: string\r\n): Promise<WikimediaImageInfo | null> {\r\n  const normalized = query.trim().toLowerCase();\r\n  if (!normalized) return null;\r\n  if (imageCache.has(normalized)) {\r\n    return imageCache.get(normalized) ?? null;\r\n  }\r\n\r\n  try {\r\n    const url = `${API_ENDPOINT}?q=${encodeURIComponent(query)}&limit=1`;\r\n    const response = await fetch(url, {\r\n      headers: {\r\n        \"User-Agent\": USER_AGENT,\r\n        \"Api-User-Agent\": USER_AGENT,\r\n      },\r\n      next: { revalidate: 60 * 60 * 12 },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      imageCache.set(normalized, null);\r\n      return null;\r\n    }\r\n\r\n    const data = (await response.json()) as WikimediaResponse;\r\n    const page = data.pages?.[0];\r\n    const image = selectImageFromPage(page);\r\n\r\n    imageCache.set(normalized, image ?? null);\r\n    return image ?? null;\r\n  } catch (error) {\r\n    console.error(\"Error fetching Wikimedia image:\", error);\r\n    imageCache.set(normalized, null);\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction selectImageFromPage(page?: WikimediaPage): WikimediaImageInfo | null {\r\n  if (!page) return null;\r\n  const candidates: WikimediaImageInfo[] = [];\r\n\r\n  if (page.originalimage?.source) {\r\n    candidates.push({\r\n      url: page.originalimage.source,\r\n      width: page.originalimage.width,\r\n      height: page.originalimage.height,\r\n    });\r\n  }\r\n\r\n  if (page.thumbnail?.url) {\r\n    candidates.push({\r\n      url: page.thumbnail.url,\r\n      width: page.thumbnail.width,\r\n      height: page.thumbnail.height,\r\n    });\r\n  }\r\n\r\n  const fallbackUrl = buildFallbackFromContentUrl(\r\n    page.content_urls?.desktop?.page\r\n  );\r\n  if (fallbackUrl) {\r\n    candidates.push({ url: fallbackUrl });\r\n  }\r\n\r\n  if (candidates.length === 0) return null;\r\n\r\n  const highResCandidate = candidates.find((candidate) =>\r\n    isHighResolutionImage(candidate)\r\n  );\r\n  return highResCandidate ?? candidates[0];\r\n}\r\n\r\nexport function isHighResolutionImage(\r\n  image?: WikimediaImageInfo | null\r\n): image is WikimediaImageInfo {\r\n  if (!image) return false;\r\n  const width = image.width ?? MIN_IMAGE_WIDTH;\r\n  return width >= MIN_IMAGE_WIDTH;\r\n}\r\n\r\nfunction buildFallbackFromContentUrl(url?: string): string | null {\r\n  if (!url) return null;\r\n  try {\r\n    const title = url.split(\"/\").pop();\r\n    if (!title) return null;\r\n    return `https://commons.wikimedia.org/wiki/Special:FilePath/${title}.jpg`;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\ninterface AssignOptions {\r\n  limit?: number;\r\n  fallback?: string;\r\n  queryFormatter?: (recipe: Recipe) => string;\r\n}\r\n\r\nexport async function assignWikimediaImages(\r\n  recipes: Recipe[],\r\n  options?: AssignOptions\r\n): Promise<void> {\r\n  if (!recipes || recipes.length === 0) return;\r\n\r\n  const {\r\n    limit = recipes.length,\r\n    fallback = DEFAULT_PLACEHOLDER,\r\n    queryFormatter,\r\n  } = options ?? {};\r\n  const uniqueRecipes = getUniqueRecipes(recipes).slice(0, limit);\r\n\r\n  const concurrency = 6;\r\n  for (let i = 0; i < uniqueRecipes.length; i += concurrency) {\r\n    const chunk = uniqueRecipes.slice(i, i + concurrency);\r\n    await Promise.all(\r\n      chunk.map(async (recipe) => {\r\n        const query = queryFormatter\r\n          ? queryFormatter(recipe)\r\n          : `${recipe.title} food`;\r\n        const wikimediaImage = await getWikimediaImage(query);\r\n        if (isHighResolutionImage(wikimediaImage)) {\r\n          recipe.image = wikimediaImage.url;\r\n          return;\r\n        }\r\n\r\n        if (!recipe.image || recipe.image.includes(\"placeholder\")) {\r\n          const curated = getCuratedImage(recipe.primaryCategory);\r\n          recipe.image = curated ?? fallback;\r\n        }\r\n      })\r\n    );\r\n  }\r\n}\r\n\r\nfunction getUniqueRecipes(recipes: Recipe[]): Recipe[] {\r\n  const map = new Map<string, Recipe>();\r\n  recipes.forEach((recipe) => {\r\n    map.set(recipe.id, recipe);\r\n  });\r\n  return [...map.values()];\r\n}\r\n\r\nexport function getPlaceholderImage(): string {\r\n  return DEFAULT_PLACEHOLDER;\r\n}\r\n\r\nexport function getCuratedImage(category?: string): string | null {\r\n  if (!category) return null;\r\n  return CATEGORY_IMAGE_FALLBACKS[category] ?? null;\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 168, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kahon/Downloads/recipe-website-with-api/lib/csv-parser.ts"],"sourcesContent":["import { promises as fs } from \"fs\"\nimport path from \"node:path\"\nimport { cache } from \"react\"\n\nexport interface Recipe {\n  id: string\n  title: string\n  description: string\n  url: string\n  rating: number | null\n  primaryCategory: string\n  cuisineTrail: string[]\n  prepTime: string\n  cookTime: string\n  totalTime: string\n  prepMinutes: number | null\n  cookMinutes: number | null\n  totalMinutes: number | null\n  servings: string\n  yield: string\n  ingredients: string[]\n  directions: string[]\n  nutrition: string\n  image: string\n  author: string\n  tags: string[]\n  diet: string\n  course: string\n}\n\ntype RawRecipe = Record<string, string>\n\nconst HEADER_ALIASES: Record<string, string> = {\n  recipe_title: \"recipe_name\",\n  image: \"img_src\",\n  picture: \"img_src\",\n  description_text: \"description\",\n}\n\nconst DATASET_PATH = path.join(process.cwd(), \"recipes.csv\")\n\nexport const getRecipes = cache(async (): Promise<Recipe[]> => {\n  try {\n    const csvText = await fs.readFile(DATASET_PATH, \"utf-8\")\n    return parseCSV(csvText)\n  } catch (error) {\n    console.error(\"Error loading recipes.csv:\", error)\n    return []\n  }\n})\n\nexport function parseCSV(csvText: string): Recipe[] {\n  const rows = tokenizeCSV(csvText)\n  if (rows.length === 0) return []\n\n  const headers = rows[0].map((header, index) => normalizeHeader(header, index))\n  const recipes: Recipe[] = []\n\n  for (let i = 1; i < rows.length; i++) {\n    const row = rows[i]\n    if (!row.some((value) => value && value.trim().length > 0)) continue\n\n    const raw: RawRecipe = {}\n    headers.forEach((header, index) => {\n      const value = row[index] ?? \"\"\n      if (header) {\n        raw[header] = value.trim()\n      }\n    })\n\n    const recipe = normalizeRecipe(raw, i)\n    if (recipe) {\n      recipes.push(recipe)\n    }\n  }\n\n  return recipes\n}\n\nfunction tokenizeCSV(text: string): string[][] {\n  const rows: string[][] = []\n  let field = \"\"\n  let row: string[] = []\n  let insideQuotes = false\n\n  for (let i = 0; i < text.length; i++) {\n    const char = text[i]\n    const nextChar = text[i + 1]\n\n    if (char === '\"') {\n      if (insideQuotes && nextChar === '\"') {\n        field += '\"'\n        i++\n      } else {\n        insideQuotes = !insideQuotes\n      }\n      continue\n    }\n\n    if (!insideQuotes && (char === \"\\n\" || char === \"\\r\")) {\n      if (char === \"\\r\" && nextChar === \"\\n\") {\n        i++\n      }\n      row.push(field)\n      rows.push(row)\n      field = \"\"\n      row = []\n      continue\n    }\n\n    if (char === \",\" && !insideQuotes) {\n      row.push(field)\n      field = \"\"\n      continue\n    }\n\n    field += char\n  }\n\n  if (field.length > 0 || row.length > 0) {\n    row.push(field)\n    rows.push(row)\n  }\n\n  return rows\n}\n\nfunction normalizeHeader(rawHeader: string, index: number): string {\n  const cleaned = (rawHeader ?? \"\").replace(/^\\uFEFF/, \"\").trim().toLowerCase()\n  if (!cleaned) {\n    return index === 0 ? \"id\" : \"\"\n  }\n\n  return HEADER_ALIASES[cleaned] ?? cleaned\n}\n\nfunction normalizeRecipe(raw: RawRecipe, fallbackIndex: number): Recipe | null {\n  const title = raw.recipe_name || raw.recipe_title\n  if (!title) return null\n\n  const cuisineTrail = buildCuisineTrail(raw.cuisine_path, raw.cuisine, raw.category)\n  const primaryCategory =\n    raw.category ||\n    raw.course ||\n    cuisineTrail[0] ||\n    \"Everyday Favorites\"\n\n  const rating = parseRating(raw.rating)\n  const ingredients = splitList(raw.ingredients)\n  const directions = splitDirections(raw.directions || raw.instructions)\n  const description = buildDescription(raw.description, directions)\n\n  return {\n    id: raw.id || String(fallbackIndex),\n    title,\n    description,\n    url: raw.url || \"#\",\n    rating,\n    primaryCategory,\n    cuisineTrail,\n    prepTime: raw.prep_time || \"\",\n    cookTime: raw.cook_time || \"\",\n    totalTime: raw.total_time || raw.timing || \"\",\n    prepMinutes: parseDuration(raw.prep_time),\n    cookMinutes: parseDuration(raw.cook_time),\n    totalMinutes: parseDuration(raw.total_time) ?? sumDurations(parseDuration(raw.prep_time), parseDuration(raw.cook_time)),\n    servings: raw.servings || \"\",\n    yield: raw.yield || \"\",\n    ingredients,\n    directions,\n    nutrition: raw.nutrition || \"\",\n    image: raw.img_src || \"/placeholder.jpg\",\n    author: raw.author || \"\",\n    tags: splitTags(raw.tags),\n    diet: raw.diet || \"\",\n    course: raw.course || \"\",\n  }\n}\n\nfunction parseRating(value?: string): number | null {\n  if (!value) return null\n  const parsed = Number.parseFloat(value)\n  return Number.isFinite(parsed) ? parsed : null\n}\n\nfunction parseDuration(value?: string): number | null {\n  if (!value) return null\n  const normalized = value.toLowerCase()\n  const regex = /(\\d+)\\s*(hours?|hrs?|hr|h|minutes?|mins?|min|m)\\b/g\n  let match: RegExpExecArray | null\n  let total = 0\n\n  while ((match = regex.exec(normalized))) {\n    const amount = Number.parseInt(match[1], 10)\n    const unit = match[2]\n    if (Number.isNaN(amount)) continue\n    if (unit.startsWith(\"h\") || unit.startsWith(\"hr\")) {\n      total += amount * 60\n    } else {\n      total += amount\n    }\n  }\n\n  return total > 0 ? total : null\n}\n\nfunction sumDurations(...values: Array<number | null | undefined>): number | null {\n  const total = values.reduce((acc, value) => (value ? acc + value : acc), 0)\n  return total > 0 ? total : null\n}\n\nfunction splitList(value?: string): string[] {\n  if (!value) return []\n  return value\n    .split(/[\\n|,]/)\n    .map((item) => item.replace(/[\"']/g, \"\").trim())\n    .filter(Boolean)\n}\n\nfunction splitDirections(value?: string): string[] {\n  if (!value) return []\n  return value\n    .split(/\\r?\\n+/)\n    .map((line) => line.replace(/[\"']/g, \"\").trim())\n    .filter(Boolean)\n}\n\nfunction splitTags(value?: string): string[] {\n  if (!value) return []\n  return value\n    .split(/[|,]/)\n    .map((tag) => tag.trim())\n    .filter(Boolean)\n}\n\nfunction buildCuisineTrail(...values: Array<string | undefined>): string[] {\n  for (const value of values) {\n    if (value && value.includes(\"/\")) {\n      const parts = value.split(\"/\").map((part) => part.trim()).filter(Boolean)\n      if (parts.length > 0) {\n        return parts\n      }\n    }\n  }\n\n  return values\n    .map((value) => value?.trim())\n    .filter((value): value is string => Boolean(value))\n}\n\nfunction buildDescription(description?: string, directions: string[] = []): string {\n  if (description) return description\n  if (directions.length === 0) return \"\"\n  return directions[0]\n}\n\nexport async function getRecipeById(id: string): Promise<Recipe | null> {\n  const recipes = await getRecipes()\n  const recipe = recipes.find((entry) => entry.id === id)\n  return recipe ?? null\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 366, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/kahon/Downloads/recipe-website-with-api/app/recipe/%5Bid%5D/page.tsx"],"sourcesContent":["import Image from \"next/image\"\r\nimport Link from \"next/link\"\r\nimport { notFound } from \"next/navigation\"\r\nimport { assignWikimediaImages } from \"@/lib/wikimedia\"\r\nimport { getRecipeById } from \"@/lib/csv-parser\"\r\n\r\ninterface RecipePageProps {\r\n  params: Promise<{\r\n    id: string\r\n  }>\r\n}\r\n\r\nexport async function generateMetadata({ params }: RecipePageProps) {\r\n  const { id } = await params\r\n  const recipe = await getRecipeById(id)\r\n  if (!recipe) {\r\n    return {\r\n      title: \"Recipe not found\",\r\n    }\r\n  }\r\n\r\n  return {\r\n    title: `${recipe.title} | Olive Recipes`,\r\n    description: recipe.description,\r\n  }\r\n}\r\n\r\nexport default async function RecipePage({ params }: RecipePageProps) {\r\n  const { id } = await params\r\n  const recipe = await getRecipeById(id)\r\n  if (!recipe) {\r\n    notFound()\r\n  }\r\n\r\n  await assignWikimediaImages([recipe], { limit: 1 })\r\n\r\n  const stats = [\r\n    { label: \"Prep\", value: recipe.prepTime || formatMinutes(recipe.prepMinutes) },\r\n    { label: \"Cook\", value: recipe.cookTime || formatMinutes(recipe.cookMinutes) },\r\n    { label: \"Total\", value: recipe.totalTime || formatMinutes(recipe.totalMinutes) },\r\n    { label: \"Servings\", value: recipe.servings || recipe.yield || \"—\" },\r\n  ]\r\n\r\n  return (\r\n    <main className=\"min-h-screen bg-background text-foreground\">\r\n      <div className=\"max-w-5xl mx-auto px-4 py-12 space-y-10\">\r\n        <Link href=\"/\" className=\"text-sm text-muted-foreground hover:text-primary transition\">\r\n          ← Back to recipes\r\n        </Link>\r\n\r\n        <header className=\"space-y-4\">\r\n          <p className=\"text-xs uppercase tracking-[0.3em] text-muted-foreground\">{recipe.primaryCategory}</p>\r\n          <h1 className=\"text-4xl font-serif font-bold text-balance\">{recipe.title}</h1>\r\n          <p className=\"text-muted-foreground text-lg\">{recipe.description}</p>\r\n        </header>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-[2fr_1fr] gap-8\">\r\n          <div className=\"relative aspect-[4/3] rounded-2xl overflow-hidden bg-muted\">\r\n            <Image src={recipe.image || \"/placeholder.jpg\"} alt={recipe.title} fill className=\"object-cover\" sizes=\"(min-width: 768px) 60vw, 100vw\" />\r\n          </div>\r\n\r\n          <aside className=\"space-y-6\">\r\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n              {stats.map((stat) => (\r\n                <div key={stat.label} className=\"bg-secondary rounded-lg p-4\">\r\n                  <p className=\"text-xs uppercase tracking-wide text-muted-foreground\">{stat.label}</p>\r\n                  <p className=\"text-lg font-semibold\">{stat.value ?? \"—\"}</p>\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            <div className=\"space-y-3\">\r\n              <p className=\"text-sm text-muted-foreground\">Rating</p>\r\n              <p className=\"text-2xl font-semibold\">{recipe.rating ? `${recipe.rating.toFixed(1)} / 5` : \"Not yet rated\"}</p>\r\n            </div>\r\n\r\n            {recipe.url && recipe.url !== \"#\" && (\r\n              <a href={recipe.url} target=\"_blank\" rel=\"noreferrer\" className=\"inline-flex items-center justify-center w-full px-4 py-2 border border-border rounded-lg text-sm font-medium hover:border-primary transition\">\r\n                View original source\r\n              </a>\r\n            )}\r\n          </aside>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-10\">\r\n          <section>\r\n            <h2 className=\"text-2xl font-serif font-semibold mb-4\">Ingredients</h2>\r\n            <ul className=\"space-y-3 text-sm\">\r\n              {recipe.ingredients.length > 0 ? (\r\n                recipe.ingredients.map((ingredient, index) => (\r\n                  <li key={`${ingredient}-${index}`} className=\"flex gap-3\">\r\n                    <span className=\"text-primary\">•</span>\r\n                    <span>{ingredient}</span>\r\n                  </li>\r\n                ))\r\n              ) : (\r\n                <li className=\"text-muted-foreground\">Ingredient details coming soon.</li>\r\n              )}\r\n            </ul>\r\n          </section>\r\n\r\n          <section>\r\n            <h2 className=\"text-2xl font-serif font-semibold mb-4\">Directions</h2>\r\n            <ol className=\"space-y-4 text-sm\">\r\n              {recipe.directions.length > 0 ? (\r\n                recipe.directions.map((step, index) => (\r\n                  <li key={`${index}-${step.slice(0, 10)}`} className=\"flex gap-4\">\r\n                    <span className=\"text-primary font-semibold\">{index + 1}.</span>\r\n                    <span>{step}</span>\r\n                  </li>\r\n                ))\r\n              ) : (\r\n                <li className=\"text-muted-foreground\">Directions not available in CSV.</li>\r\n              )}\r\n            </ol>\r\n          </section>\r\n        </div>\r\n\r\n        {recipe.nutrition && (\r\n          <section className=\"border border-border rounded-2xl p-6\">\r\n            <h2 className=\"text-xl font-semibold mb-2\">Estimated nutrition</h2>\r\n            <p className=\"text-sm text-muted-foreground\">{recipe.nutrition}</p>\r\n          </section>\r\n        )}\r\n      </div>\r\n    </main>\r\n  )\r\n}\r\n\r\nfunction formatMinutes(value: number | null | undefined): string | null {\r\n  if (!value) return null\r\n  if (value < 60) return `${value} mins`\r\n  const hours = Math.floor(value / 60)\r\n  const minutes = value % 60\r\n  if (minutes === 0) return `${hours} hr${hours > 1 ? \"s\" : \"\"}`\r\n  return `${hours} hr${hours > 1 ? \"s\" : \"\"} ${minutes} min`\r\n}\r\n\r\n"],"names":[],"mappings":"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"}}]
}